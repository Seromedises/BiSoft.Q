function F_pull = PullForce(ConstantParameters,GeometricParams,p,stroke,method)

[L,~,~,~,~,alpha,delta,gamma,~,~,~] = struct('x', num2cell(ConstantParameters)).x;
[rc0,rc,phi_c,phi_v,rs1,x0s1,rs2,x0s2,vmax] = struct('x', num2cell(GeometricParams)).x;

N = 2*pi/alpha;

function Nx1 = myfunc_Nx1(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)
    Nx1 = (cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v))-sin(v).*(rc0.*sin(v)+rc0.^2.*cos(v).*sin(v).*1.0./sqrt(-rc0.^2.*sin(v).^2+rc.^2))).*((cos(u).*cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(sin(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta)))-cos(u).*sin(u).*1.0./sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))).^2+1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))).^2))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0)+(cos(v).*sin(u).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(cos(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta)))-sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))).^2+1.0)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0));
end

function Nx2 = myfunc_Nx2(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)
    Nx2 = -(cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v))-sin(v).*(rc0.*sin(v)+rc0.^2.*cos(v).*sin(v).*1.0./sqrt(-rc0.^2.*sin(v).^2+rc.^2))).*((cos(v).*sin(u).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./(cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0))-(1.0./cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).^2.*cos(u).*cos(v).*sin(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0));
end

function Nx3 = myfunc_Nx3(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)
    Nx3 = (cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v))-sin(v).*(rc0.*sin(v)+rc0.^2.*cos(v).*sin(v).*1.0./sqrt(-rc0.^2.*sin(v).^2+rc.^2))).*((cos(u).*cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(sin(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))+cos(alpha./2.0-u).*sin(alpha./2.0-u).*1.0./sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma)).^2+1.0).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma)).^2).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0))-(cos(v).*sin(u).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma)).^2+1.0)+cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0)));
end

function Ny1 = myfunc_Ny1(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)
    Ny1 = (cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v))-sin(v).*(rc0.*sin(v)+rc0.^2.*cos(v).*sin(v).*1.0./sqrt(-rc0.^2.*sin(v).^2+rc.^2))).*((cos(u).*cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(cos(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta)))-sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))).^2+1.0)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0)-(cos(v).*sin(u).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(sin(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta)))-cos(u).*sin(u).*1.0./sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))).^2+1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))).^2))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0));
end

function Ny2 = myfunc_Ny2(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)
    Ny2 = -(cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v))-sin(v).*(rc0.*sin(v)+rc0.^2.*cos(v).*sin(v).*1.0./sqrt(-rc0.^2.*sin(v).^2+rc.^2))).*((cos(u).*cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./(cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0))+(1.0./cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).^2.*cos(v).*sin(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*sin(u).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0));
end

function Ny3 = myfunc_Ny3(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)
    Ny3 = -(cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v))-sin(v).*(rc0.*sin(v)+rc0.^2.*cos(v).*sin(v).*1.0./sqrt(-rc0.^2.*sin(v).^2+rc.^2))).*((cos(v).*sin(u).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(sin(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))+cos(alpha./2.0-u).*sin(alpha./2.0-u).*1.0./sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma)).^2+1.0).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma)).^2).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0))+(cos(u).*cos(v).*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).*(sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma)).^2+1.0)+cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))-1.0))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(v).^2.*(sqrt(-rc0.^2.*sin(v).^2+rc.^2)+rc0.*cos(v)).^2+rs1.^2))).*tan(delta))-1.0)));
end

function F1 = myfunc_F1(u,rc0,rc,rs1,x0s1,rs2,x0s2,L,stroke)
    F1 = (L.*sqrt(((cos(vmax).*sin(u).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta)))-sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2+1.0)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)+(cos(u).*cos(vmax).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(sin(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta)))-cos(u).*sin(u).*1.0./sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2+1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)).^2+((cos(u).*cos(vmax).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta)))-sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2+1.0)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)-(cos(vmax).*sin(u).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(sin(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta)))-cos(u).*sin(u).*1.0./sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2+1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)).^2))./(tan(atan(((((rc0+sqrt(rc.^2)).*(cos(u).*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta)))+sqrt(-sin(u).^2.*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))).^2+1.0)))./((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))+1.0)-(cos(vmax).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta)))-sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2+1.0)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)).*2.0)./(L+stroke)).*2.0).*2.0);
end

function F2 = myfunc_F2(u,rc0,rc,rs1,x0s1,rs2,x0s2,L,stroke)
    F2 = (L.*sqrt(((cos(u).*cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)))./(cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))+(1.0./cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).^2.*cos(vmax).*sin(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*sin(u).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)).^2+((cos(vmax).*sin(u).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)))./(cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))-(1.0./cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).^2.*cos(u).*cos(vmax).*sin(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)).^2))./(tan(atan(((((rc0+sqrt(rc.^2)).*((((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))).*(sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))-1.0))./(cos(u+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))).*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))+1.0))+(cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)))./(cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))).*2.0)./(L+stroke)).*2.0).*2.0);
end

function F3 = myfunc_F3(u,rc0,rc,rs1,x0s1,rs2,x0s2,L,stroke)
    F3 = (L.*sqrt(((cos(u).*cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))+sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2+1.0)))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))+(cos(vmax).*sin(u).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(sin(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))+cos(alpha./2.0-u).*sin(alpha./2.0-u).*1.0./sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2+1.0).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))).^2+((cos(vmax).*sin(u).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))+sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2+1.0)))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))-(cos(u).*cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(sin(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))+cos(alpha./2.0-u).*sin(alpha./2.0-u).*1.0./sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2+1.0).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))).^2))./(tan(atan(((((rc0+sqrt(rc.^2)).*(cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))-sin(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./tan(gamma))+sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))-sin(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./tan(gamma)).^2+1.0)).*((((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))).*(sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))-1.0))./((cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))).*(cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))-sin(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./tan(gamma))-1.0).*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))+1.0))+(cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))+sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2+1.0)))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))).*2.0)./(L+stroke)).*2.0).*2.0);
end

int_lb = [0 delta, alpha/2-gamma];
int_ub = [delta,alpha/2-gamma,alpha/2];
[Fpx,Fpy,F] = deal(zeros(3,1));

if strcmp(method,"method_1") | strcmp(method,"method_2")
    myfuncs_Ny = {@(u,v) myfunc_Ny1(u,v,rc0,rc,rs1,x0s1,rs2,x0s2); @(u,v) myfunc_Ny2(u,v,rc0,rc,rs1,x0s1,rs2,x0s2); @(u,v) myfunc_Ny3(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)};
    for jj=1:3
        Fpy(jj) = p*integral2(myfuncs_Ny{jj},int_lb(jj),int_ub(jj),-vmax,vmax,'AbsTol',1e-4,'RelTol',1e-2);
    end
end

switch method
    case "method_1"
        myfuncs_Nx = {@(u,v) myfunc_Nx1(u,v,rc0,rc,rs1,x0s1,rs2,x0s2); @(u,v) myfunc_Nx2(u,v,rc0,rc,rs1,x0s1,rs2,x0s2); @(u,v) myfunc_Nx3(u,v,rc0,rc,rs1,x0s1,rs2,x0s2)};
        for jj=1:3
            Fpx(jj) = p*integral2(myfuncs_Nx{jj},int_lb(jj),int_ub(jj),-vmax,vmax,'AbsTol',1e-4,'RelTol',1e-2);
        end
        Fpx = sum(Fpx);
        Fpy = sum(Fpy);
        Fpxy = sqrt(Fpx^2+Fpy^2); 
        zita = pi/2-alpha/2-atan(Fpy/Fpx);
        Fp_radial = 2*Fpxy*cos(zita); 
        F_pull = N*Fp_radial/(2*tan(phi_v)); 
    case "method_2"
        Fp_radial = 2*sum(Fpy); 
        F_pull = N*Fp_radial/(2*tan(phi_c)); 
    case "method_3"
        myfuncs_F = {@(u) myfunc_F1(u,rc0,rc,rs1,x0s1,rs2,x0s2,L,stroke); @(u) myfunc_F2(u,rc0,rc,rs1,x0s1,rs2,x0s2,L,stroke); @(u) myfunc_F3(u,rc0,rc,rs1,x0s1,rs2,x0s2,L,stroke)};
        for jj=1:3
            F(jj) =  p*integral(myfuncs_F{jj},int_lb(jj),int_ub(jj),'AbsTol',1e-4,'RelTol',1e-2);
        end
        F_pull = 2*N*sum(F); 
    otherwise
        F_pull = NaN;
end

end
