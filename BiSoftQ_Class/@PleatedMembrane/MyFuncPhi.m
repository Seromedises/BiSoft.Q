function [phi_func1,phi_func2,phi_func3] = MyFuncPhi(obj,rc,rc0,rs1,x0s1,rs2,x0s2,stroke,vmax)

alpha = obj.alpha;
delta = obj.delta;
gamma = obj.gamma;
L = obj.L;

% angle subtended by the longitudinal arcs (function of the longitude u)
phi_func1 = @(u) atan(((((rc0+sqrt(rc.^2)).*(cos(u).*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta)))+sqrt(-sin(u).^2.*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))).^2+1.0)))./((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))+1.0)-(cos(vmax).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(u).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta)))-sqrt(-sin(u).^2.*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))).^2+1.0)))./((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0)).*2.0)./(L+stroke)).*2.0;
phi_func2 = @(u) atan(((((rc0+sqrt(rc.^2)).*((((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))).*(sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))-1.0))./(cos(u+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))).*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))+1.0))+(cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)))./(cos(u+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))).*2.0)./(L+stroke)).*2.0;
phi_func3 = @(u) atan(((((rc0+sqrt(rc.^2)).*(cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))-sin(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./tan(gamma))+sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))-sin(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./tan(gamma)).^2+1.0)).*((((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))).*(sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))-1.0))./((cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))).*(cos(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))-sin(alpha./2.0+atan2(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)),sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))))./tan(gamma))-1.0).*((sin(delta).*(x0s1+sqrt(rs1.^2))-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))+(cos(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)))./(abs(cos(delta).*(x0s1+sqrt(rs1.^2)).*1i+sin(delta).*(x0s1+sqrt(rs1.^2))-cos(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2)).*1i-sin(alpha./2.0-gamma).*(x0s2+sqrt(rs2.^2))).*tan(delta))+1.0))+(cos(vmax).*(((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))-1.0).*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).*(cos(alpha./2.0-u).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))+sqrt(-sin(alpha./2.0-u).^2.*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma)).^2+1.0)))./((cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))).*(cos(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))-sin(alpha./2.0+atan2(-cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)),-sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))+sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))))./tan(gamma))-1.0).*((sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))+(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)))./(abs(cos(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2)).*1i+sin(alpha./2.0-gamma).*(x0s2+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs2.^2))-cos(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2)).*1i-sin(delta).*(x0s1+sqrt(-sin(vmax).^2.*(sqrt(-rc0.^2.*sin(vmax).^2+rc.^2)+rc0.*cos(vmax)).^2+rs1.^2))).*tan(delta))-1.0))).*2.0)./(L+stroke)).*2.0;

end